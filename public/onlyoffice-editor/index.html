<html>
<head>
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>

  <title>Edit ONLYOFFICE</title>

  <script id="scriptApi" type="text/javascript" src="/onlyoffice/web-apps/apps/api/documents/api.js"></script>

  <style>
    html {
      height: 100%;
      width: 100%;
    }
    body {
      background: #fff;
      color: #333;
      font-family: Arial, Tahoma, sans-serif;
      font-size: 12px;
      font-weight: normal;
      height: 100%;
      margin: 0;
      padding: 0;
      text-decoration: none;
    }
    form {
      height: 100%;
    }
    div {
      margin: 0;
      padding: 0;
    }
  </style>

</head>

<body>
<div>
  <div id="placeholder"></div>
</div>
<script>

  function getQueryParams() {
    let query = window.location.search.substring(1);
    let vars = query.split("&");
    let params = {};
    for (let i = 0; i < vars.length; i++) {
      let pair = vars[i].split("=");
      params[pair[0]] = decodeURIComponent(pair[1]);
    }
    return params
  }

  const params = getQueryParams();

  fetch('/gateway/transformations/api/doc-editor/onlyoffice/config?ref=' + params.ref)
    .then(r => r.json())
    .then(config => {
      new DocsAPI.DocEditor("placeholder", {
        onlyofficeUrl: '/onlyoffice/',
        ...config,
        type: "desktop",
        width: "100%",
        height: "100%"
      });
    }).catch(e => {

  });
</script>
</body>
</html>
